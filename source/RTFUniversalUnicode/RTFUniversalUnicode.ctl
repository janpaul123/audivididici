VERSION 5.00
Object = "{3B7C8863-D78F-101B-B9B5-04021C009402}#1.2#0"; "RICHTX32.OCX"
Begin VB.UserControl RTFUniversalUnicode 
   BackStyle       =   0  'Transparent
   ClientHeight    =   2610
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   2490
   ScaleHeight     =   2610
   ScaleWidth      =   2490
   Begin RichTextLib.RichTextBox rtfHelp 
      Height          =   1815
      Left            =   1080
      TabIndex        =   15
      Top             =   840
      Visible         =   0   'False
      Width           =   1815
      _ExtentX        =   3201
      _ExtentY        =   3201
      _Version        =   393217
      ReadOnly        =   -1  'True
      ScrollBars      =   2
      TextRTF         =   $"RTFUniversalUnicode.ctx":0000
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   12
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   0
      Left            =   360
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":007C
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   1
      Left            =   720
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":00F8
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   2
      Left            =   1080
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":0174
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   3
      Left            =   1440
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":01F0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   4
      Left            =   1800
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":026C
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   5
      Left            =   360
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   840
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":02E8
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   8
      Left            =   1440
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   840
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":0364
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   9
      Left            =   1800
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   840
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":03E0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   10
      Left            =   360
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":045C
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   11
      Left            =   720
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":04D8
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   12
      Left            =   1080
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":0554
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   13
      Left            =   1440
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":05D0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   14
      Left            =   1800
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":064C
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   7
      Left            =   1080
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   840
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":06C8
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin RichTextLib.RichTextBox myRTF 
      CausesValidation=   0   'False
      Height          =   615
      Index           =   6
      Left            =   720
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   840
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   1085
      _Version        =   393217
      MultiLine       =   0   'False
      Appearance      =   0
      TextRTF         =   $"RTFUniversalUnicode.ctx":0744
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Gentium"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Image myRTFButton 
      Height          =   765
      Index           =   1
      Left            =   0
      Picture         =   "RTFUniversalUnicode.ctx":07C0
      Top             =   1440
      Width           =   405
   End
   Begin VB.Image myRTFButton 
      Height          =   765
      Index           =   0
      Left            =   120
      Picture         =   "RTFUniversalUnicode.ctx":18BE
      Top             =   1680
      Width           =   405
   End
   Begin VB.Shape shp2 
      BorderColor     =   &H00C0C0C0&
      Height          =   1815
      Left            =   15
      Top             =   0
      Width           =   1815
   End
   Begin VB.Shape shp1 
      BorderColor     =   &H00808080&
      Height          =   1815
      Left            =   0
      Top             =   0
      Width           =   1815
   End
   Begin VB.Image img1 
      Height          =   2025
      Left            =   360
      Picture         =   "RTFUniversalUnicode.ctx":29BC
      Top             =   480
      Width           =   2070
   End
End
Attribute VB_Name = "RTFUniversalUnicode"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

'Default Property Values:
Const m_def_ForeColor = &H80000012
'Property Variables:
Dim m_ForeColor As OLE_COLOR
'Event Declarations:
Event Click() 'MappingInfo=UserControl,UserControl,-1,Click
Attribute Click.VB_Description = "Occurs when the user presses and then releases a mouse button over an object."
Event DblClick() 'MappingInfo=UserControl,UserControl,-1,DblClick
Attribute DblClick.VB_Description = "Occurs when the user presses and releases a mouse button and then presses and releases it again over an object."
Event MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single) 'MappingInfo=UserControl,UserControl,-1,MouseDown
Attribute MouseDown.VB_Description = "Occurs when the user presses the mouse button while an object has the focus."
Event MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single) 'MappingInfo=UserControl,UserControl,-1,MouseMove
Attribute MouseMove.VB_Description = "Occurs when the user moves the mouse."
Event MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single) 'MappingInfo=UserControl,UserControl,-1,MouseUp
Attribute MouseUp.VB_Description = "Occurs when the user releases the mouse button while an object has the focus."
Event ChangeRTF(SelRTF As String)
Event RTFSetFocus()
Event CheckSigma()

Enum rtfKeyboardConstants
    kbdLatin = 0
    kbdGreek = 1
End Enum

Enum rtfMarkupConstants
    lamNothing = 0
    lamAcute = 1
    lamGrave = 2
    lamCircumflex = 3
    lamDiaresis = 4
    lamTilde = 5
    lamMacron = 6
    lamBreve = 7
    lamRing = 8
    lamCedilla = 9
    lamOgonek = 10
    lamCaron = 11
    lamDotAbove = 12
    lamDotBelow = 13
    lamLigature = 14
    grmNothing = 0
    grmPsili = 1
    grmDasia = 2
    grmVaria = 3
    grmOxia = 4
    grmPerispomeni = 5
    grmPsiliVaria = 6
    grmPsiliOxia = 7
    grmPsiliPerispomeni = 8
    grmDasiaVaria = 9
    grmDasiaOxia = 10
    grmDasiaPerispomeni = 11
    grmVrachy = 12
    grmMacron = 13
    grmDialyticaVaria = 14
    grmDialyticaOxia = 15
    grmDialyticaPerispomeni = 16
End Enum

Enum rtfStyleConstants
    rtfLower = 0
    rtfUpper = 1
    rtfLowerAlt = 2
    rtfUpperAlt = 3
End Enum

Private rtfKeyboard As rtfKeyboardConstants

Private rtfMarkup As rtfMarkupConstants
Private rtfStyle As rtfStyleConstants

Private rtfMenu As Integer
Private rtfMenuSub As Integer
Private rtfMenuVisible As Boolean

Private rtfMenuShift As Boolean
Private rtfMenuAlt As Boolean

Private myRTF_CacheRTF(40) As String
Private myRTF_CacheTag(40) As Integer

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MappingInfo=UserControl,UserControl,-1,BackColor
Public Property Get BackColor() As OLE_COLOR
Attribute BackColor.VB_Description = "Returns/sets the background color used to display text and graphics in an object."
    BackColor = UserControl.BackColor
End Property

Public Property Let BackColor(ByVal New_BackColor As OLE_COLOR)
    UserControl.BackColor() = New_BackColor
    PropertyChanged "BackColor"
End Property

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MemberInfo=10,0,0,&H80000012&
Public Property Get ForeColor() As OLE_COLOR
Attribute ForeColor.VB_Description = "Returns/sets the foreground color used to display text and graphics in an object."
    ForeColor = m_ForeColor
End Property

Public Property Let ForeColor(ByVal New_ForeColor As OLE_COLOR)
    m_ForeColor = New_ForeColor
    PropertyChanged "ForeColor"
End Property

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MappingInfo=UserControl,UserControl,-1,Enabled
Public Property Get Enabled() As Boolean
Attribute Enabled.VB_Description = "Returns/sets a value that determines whether an object can respond to user-generated events."
    Enabled = UserControl.Enabled
End Property

Public Property Let Enabled(ByVal New_Enabled As Boolean)
    UserControl.Enabled() = New_Enabled
    PropertyChanged "Enabled"
End Property

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MappingInfo=UserControl,UserControl,-1,BackStyle
Public Property Get BackStyle() As Integer
Attribute BackStyle.VB_Description = "Indicates whether a Label or the background of a Shape is transparent or opaque."
    BackStyle = UserControl.BackStyle
End Property

Public Property Let BackStyle(ByVal New_BackStyle As Integer)
    UserControl.BackStyle() = New_BackStyle
    PropertyChanged "BackStyle"
End Property

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MappingInfo=UserControl,UserControl,-1,BorderStyle
Public Property Get BorderStyle() As Integer
Attribute BorderStyle.VB_Description = "Returns/sets the border style for an object."
    BorderStyle = UserControl.BorderStyle
End Property

Public Property Let BorderStyle(ByVal New_BorderStyle As Integer)
    UserControl.BorderStyle() = New_BorderStyle
    PropertyChanged "BorderStyle"
End Property

Private Sub myRTF_KeyDown(Index As Integer, myKeycode As Integer, Shift As Integer)
    Dim newIndex As Integer
    Dim i As Integer
    
    newIndex = Index
    
    RTFKeyDown myKeycode, Shift
    
    i = 0
    
    Select Case myKeycode
        Case vbKeyUp
            Do
                If newIndex > 4 Then
                    newIndex = newIndex - 5
                Else
                    newIndex = newIndex + 5
                End If
                i = i + 1
            Loop While myRTF(newIndex).Tag = 0 And i < 20
            myRTF(newIndex).SetFocus
        Case vbKeyDown
            Do
                If newIndex < 10 Then
                    newIndex = newIndex + 5
                Else
                    newIndex = newIndex - 10
                End If
                i = i + 1
            Loop While myRTF(newIndex).Tag = 0 And i < 20
            myRTF(newIndex).SetFocus
        Case vbKeyRight
            Do
                If newIndex < 14 Then
                    newIndex = newIndex + 1
                Else
                    newIndex = 0
                End If
                i = i + 1
            Loop While myRTF(newIndex).Tag = 0 And i < 20
            myRTF(newIndex).SetFocus
        Case vbKeyLeft
            Do
                If newIndex > 0 Then
                    newIndex = newIndex - 1
                Else
                    newIndex = 14
                End If
                i = i + 1
            Loop While myRTF(newIndex).Tag = 0 And i < 20
            myRTF(newIndex).SetFocus
    End Select
    
    If i >= 20 Then
        myRTF(0).SetFocus
    End If
    
    myKeycode = 0
End Sub

Private Sub myRTF_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    On Error Resume Next
    If Len(myRTF(Index).Text) > 0 Then
        myRTF(Index).SetFocus
    End If
End Sub

Private Sub myRTF_MouseUp(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    On Error Resume Next
    
    Dim i As Integer
    
    If Button = vbLeftButton And myRTF(Index).Tag > 0 Then
        If myRTF(Index).Tag = 1 Then
            rtfHelp.Enabled = True
            rtfHelp.Visible = True
            rtfHelp.ZOrder vbBringToFront
        ElseIf myRTF(Index).Tag = 2 Then
            ShowMenu rtfMenu, rtfMenuSub - 1
        ElseIf myRTF(Index).Tag = 3 Then
            ShowMenu rtfMenu, rtfMenuSub + 1
        Else
            If rtfMenu = 0 Then
                ShowMenu myRTF(Index).Tag, 0
            Else
                PrintUnicode myRTF(Index).Tag
                HideMenu
            End If
        End If
    ElseIf Button = vbMiddleButton Then
        If rtfMenu = 0 Then
            HideMenu
        Else
            ShowMenu 0, 0
        End If
    ElseIf Button = vbRightButton Or Not myRTF(Index).Tag > 0 Then
        HideMenu
    
        For i = 0 To 14
            myRTF(i).Left = UserControl.Width + 1000
        Next i
    End If
End Sub

Private Sub myRTF_SelChange(Index As Integer)
    If myRTF(Index).SelStart <> 0 Then
        myRTF(Index).SelStart = 0
    End If
    If myRTF(Index).SelLength <> Len(myRTF(Index).Text) Then
        myRTF(Index).SelLength = Len(myRTF(Index).Text)
    End If
End Sub

Private Sub myRTF_KeyUp(Index As Integer, myKeycode As Integer, Shift As Integer)
    RTFKeyUp myKeycode, Shift
    If myKeycode = vbKeySpace Or myKeycode = vbKeyReturn Then
        myRTF_MouseUp Index, vbLeftButton, 0, 0, 0
    End If
End Sub

Private Sub myRTFbutton_DblClick(Index As Integer)
    RaiseEvent DblClick
End Sub

Private Sub myRTFButton_MouseUp(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    If Button = vbLeftButton Then
        RaiseEvent Click
    End If
End Sub

Private Sub rtfHelp_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    If Button = vbRightButton Then
        rtfHelp.Visible = False
        rtfHelp.Enabled = False
        rtfHelp.ZOrder vbSendToBack
        HideMenu
    End If
End Sub

Private Sub UserControl_Initialize()
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim myLeft As Integer
    Dim myTop As Integer
    
    i = 0
    myTop = 30
    For j = 0 To 2
        myLeft = 30
        For k = 0 To 4
            myRTF(i).Left = myLeft
            myRTF(i).Top = myTop
            myLeft = myLeft + myRTF(0).Width
            i = i + 1
        Next k
        myTop = myTop + myRTF(0).Height
    Next j
    
    shp1.Left = 0
    shp2.Left = 1
    shp1.Top = 0
    shp2.Top = 1
    shp1.Width = myLeft + 10
    shp2.Width = myLeft + 10
    shp1.Height = myTop + 10
    shp2.Height = myTop + 10
    img1.Left = -10
    img1.Top = -10
    UserControl.Width = myLeft + 60
    UserControl.Height = myTop + 60
    
    For i = 0 To 1
        myRTFButton(i).Left = UserControl.Width / 2 - myRTFButton(i).Width / 2
        myRTFButton(i).Top = UserControl.Height / 2 - myRTFButton(i).Height / 2
    Next i
    
    For i = 0 To 14
        myRTF(i).MousePointer = rtfArrow
        myRTF(i).BorderStyle = rtfNoBorder
    Next i
    rtfHelp.Left = 0
    rtfHelp.Top = 0
    rtfHelp.Width = myLeft
    rtfHelp.Height = myTop
    
    shp1.Visible = False
    shp2.Visible = False
    img1.Visible = False
    
    SetKeyboard kbdLatin
    
    rtfMenuShift = False
End Sub

Private Sub UserControl_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    RaiseEvent MouseDown(Button, Shift, X, Y)
End Sub

Private Sub UserControl_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    RaiseEvent MouseMove(Button, Shift, X, Y)
End Sub

Private Sub UserControl_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    RaiseEvent MouseUp(Button, Shift, X, Y)
End Sub

Sub DoMarkupMenu(myMarkup As rtfMarkupConstants)
    If rtfKeyboard = kbdLatin Then
        If rtfMenuVisible Then
            If rtfMenu >= Asc("a") And rtfMenu <= Asc("z") Then
                PrintLetter vbKeyA + rtfMenu - Asc("a"), myMarkup, rtfLower
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
                HideMenu
            ElseIf rtfMenu >= Asc("A") And rtfMenu <= Asc("Z") Then
                PrintLetter vbKeyA + rtfMenu - Asc("A"), myMarkup, rtfUpper
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                ShowMenu CInt(myMarkup), 0
            End If
        Else
            ShowMenu CInt(myMarkup), 0
        End If
    ElseIf rtfKeyboard = kbdGreek Then
        If rtfMenuVisible Then
            Select Case rtfMenu
                Case 945
                    PrintLetter vbKeyA, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 913
                    PrintLetter vbKeyA, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 8115
                    PrintLetter vbKeyA, myMarkup, rtfLowerAlt
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 949
                    PrintLetter vbKeyE, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 917
                    PrintLetter vbKeyE, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 951
                    PrintLetter vbKeyH, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 919
                    PrintLetter vbKeyH, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 8131
                    PrintLetter vbKeyH, myMarkup, rtfLowerAlt
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 953
                    PrintLetter vbKeyI, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 921
                    PrintLetter vbKeyI, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 959
                    PrintLetter vbKeyO, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 927
                    PrintLetter vbKeyO, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 961
                    PrintLetter vbKeyR, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 929
                    PrintLetter vbKeyR, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 965
                    PrintLetter vbKeyU, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 933
                    PrintLetter vbKeyU, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 969
                    PrintLetter vbKeyW, myMarkup, rtfLower
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 937
                    PrintLetter vbKeyW, myMarkup, rtfUpper
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case 8179
                    PrintLetter vbKeyW, myMarkup, rtfLowerAlt
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Case Else
                    ShowMenu CInt(myMarkup), 0
            End Select
        Else
            ShowMenu CInt(myMarkup), 0
        End If
    End If
End Sub


'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MemberInfo=14
Public Sub RTFKeyDown(ByRef KeyCode As Integer, ByRef Shift As Integer)
Attribute RTFKeyDown.VB_Description = "Pass through KeyDown event of RichTextBox."
    Dim myKeycode As Integer
    
    myKeycode = KeyCode
    
    If Shift = 7 Then
        DoEvents
    End If
    
    If (Shift And vbCtrlMask) = vbCtrlMask And (Shift And vbAltMask) <> vbAltMask Then Exit Sub
    If ((myKeycode < vbKeyA Or myKeycode > vbKeyZ) And (myKeycode <> vbKeyV Or rtfKeyboard <> kbdLatin) And (myKeycode <> 190 Or rtfKeyboard <> kbdLatin) And (myKeycode <> 188 Or rtfKeyboard <> kbdLatin) And myKeycode <> 18 And (myKeycode <> vbKeyShift Or rtfKeyboard = kbdGreek) And ((Shift And vbAltMask) = vbAltMask)) Then Exit Sub
    
    If (Shift And vbCtrlMask) = vbCtrlMask And (Shift And vbAltMask) = vbAltMask Then
        rtfStyle = rtfLowerAlt
    Else
        rtfStyle = rtfLower
    End If
    
    If myKeycode >= vbKeyA And myKeycode <= vbKeyZ And (Shift And vbShiftMask) = vbShiftMask Then
        rtfStyle = rtfStyle + 1
    End If
    
    If rtfKeyboard = kbdLatin Then
        
        If (myKeycode >= vbKeyA And myKeycode <= vbKeyZ) Or (myKeycode = vbKeySpace And (rtfMarkup <> lamNothing)) Then
            If rtfMenuVisible Then
                If rtfMenu = 0 And (myKeycode >= vbKeyA And myKeycode <= vbKeyZ) Then
                    PrintLetter myKeycode, rtfMarkup, rtfStyle, -2
                    Exit Sub
                Else
                    HideMenu
                End If
            End If
        End If
        
        If (myKeycode >= vbKeyA And myKeycode <= vbKeyZ And (myKeycode <> vbKeyV Or Shift <> 6)) Or (myKeycode = vbKeySpace And (rtfMarkup <> lamNothing)) Then
            PrintLetter myKeycode, rtfMarkup, rtfStyle
            KeyCode = 0
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
        End If
        
        If (myKeycode = vbKeySpace And (rtfMarkup = lamNothing)) Or myKeycode = 188 Or myKeycode = 190 Or myKeycode = 186 Or myKeycode = 191 Or myKeycode = 220 Then
            RaiseEvent CheckSigma
        End If
        
        If myKeycode = 222 And (Shift And vbShiftMask) = 0 Then ''
            If rtfMenuVisible And rtfMenu = lamAcute Then
                PrintUnicode Asc("'")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamAcute
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 222 And (Shift And vbShiftMask) = vbShiftMask Then '"
            If rtfMenuVisible And rtfMenu = lamDiaresis Then
                PrintUnicode 34 ' "
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamDiaresis
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 192 And (Shift And vbShiftMask) = 0 Then '`
            If rtfMenuVisible And rtfMenu = lamGrave Then
                PrintUnicode Asc("`")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamGrave
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 192 And (Shift And vbShiftMask) = vbShiftMask Then '~
            If rtfMenuVisible And rtfMenu = lamTilde Then
                PrintUnicode Asc("~")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamTilde
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = vbKey6 And (Shift And vbShiftMask) = vbShiftMask Then '^
            If rtfMenuVisible And rtfMenu = lamCircumflex Then
                PrintUnicode Asc("^")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamCircumflex
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 189 And (Shift And vbShiftMask) = 0 Then '-
            If rtfMenuVisible And rtfMenu = lamMacron Then
                PrintUnicode Asc("-")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamMacron
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 189 And (Shift And vbShiftMask) = vbShiftMask Then '_
            If rtfMenuVisible And rtfMenu = lamBreve Then
                PrintUnicode Asc("_")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamBreve
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 187 And (Shift And vbShiftMask) = 0 Then '=
            If rtfMenuVisible And rtfMenu = lamRing Then
                PrintUnicode Asc("=")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamRing
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 187 And (Shift And vbShiftMask) = vbShiftMask Then '+
            If rtfMenuVisible And rtfMenu = lamLigature Then
                PrintUnicode Asc("+")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamLigature
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 188 And (Shift And vbAltMask) = vbAltMask And (Shift And vbCtrlMask) = vbCtrlMask Then 'ralt + ,
            If rtfMenuVisible And rtfMenu = lamCedilla Then
                PrintUnicode Asc(",")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamCedilla
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 188 And Shift = (6 Or vbShiftMask) Then 'ralt + <
            If rtfMenuVisible And rtfMenu = lamOgonek Then
                PrintUnicode Asc("<")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamOgonek
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = vbKeyV And (Shift And vbAltMask) = vbAltMask And (Shift And vbCtrlMask) = vbCtrlMask Then 'ralt + v
            If rtfMenuVisible And rtfMenu = lamCaron Then
                PrintUnicode Asc("v")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamCaron
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 190 And (Shift And vbAltMask) = vbAltMask And (Shift And vbCtrlMask) = vbCtrlMask Then 'ralt + .
            If rtfMenuVisible And rtfMenu = lamDotBelow Then
                PrintUnicode Asc(".")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamDotBelow
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = 190 And Shift = (6 Or vbShiftMask) Then 'ralt + >
            If rtfMenuVisible And rtfMenu = lamDotAbove Then
                PrintUnicode Asc(">")
                rtfMarkup = lamNothing
                rtfStyle = rtfLower
                HideMenu
            Else
                rtfMarkup = lamDotAbove
                rtfStyle = rtfLower
                DoMarkupMenu rtfMarkup
                KeyCode = 0
            End If
        ElseIf myKeycode = vbKeyShift Then
            If Not rtfMenuShift Then
                rtfMenuShift = True
                If rtfMenuVisible Then
                    ShowMenu rtfMenu, rtfMenuSub
                End If
            End If
        ElseIf myKeycode = vbKeyEscape Then
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
            HideMenu
        ElseIf myKeycode = vbKeyBack Then
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
            HideMenu
        ElseIf myKeycode = vbKeyDelete Then
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
            HideMenu
        ElseIf myKeycode = 18 Then
            'alt
            If Not rtfMenuAlt And (Shift And vbAltMask) = vbAltMask And (Shift And vbCtrlMask) = vbCtrlMask Then
                rtfMenuAlt = True
                If rtfMenuVisible Then
                    If rtfMenu = 0 Then
                        ShowMenu -1, rtfMenuSub
                    Else
                        ShowMenu rtfMenu, rtfMenuSub
                    End If
                End If
            End If
        Else
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
        End If
        
    ElseIf rtfKeyboard = kbdGreek Then
        
        If (myKeycode >= vbKeyA And myKeycode <= vbKeyZ) Or (myKeycode = vbKeySpace And (rtfMarkup <> grmNothing And rtfMarkup <> grmVrachy And rtfMarkup <> grmMacron)) Then
            If rtfMenuVisible Then
                If rtfMenu = 0 And (myKeycode = vbKeyA Or myKeycode = vbKeyE Or myKeycode = vbKeyH Or myKeycode = vbKeyI Or myKeycode = vbKeyO Or myKeycode = vbKeyR Or (myKeycode = vbKeyS And Not rtfMenuShift) Or (myKeycode = vbKeyV And Not rtfMenuShift) Or myKeycode = vbKeyU Or myKeycode = vbKeyY Or myKeycode = vbKeyW) Then
                    If myKeycode = vbKeyV Then
                        PrintLetter vbKeyS, rtfMarkup, rtfStyle, -2
                    Else
                        PrintLetter myKeycode, rtfMarkup, rtfStyle, -2
                    End If
                    Exit Sub
                Else
                    HideMenu
                End If
            End If
        End If
        
        If (myKeycode >= vbKeyA And myKeycode <= vbKeyZ) Or (myKeycode = vbKeySpace And (rtfMarkup <> grmNothing And rtfMarkup <> grmVrachy And rtfMarkup <> grmMacron)) Then
            PrintLetter myKeycode, rtfMarkup, rtfStyle
            KeyCode = 0
            rtfMarkup = grmNothing
            rtfStyle = rtfLower
        End If
        
        If (myKeycode = vbKeySpace And (rtfMarkup = grmNothing Or rtfMarkup = grmVrachy Or rtfMarkup = grmMacron)) Or myKeycode = 188 Or myKeycode = 190 Or myKeycode = 186 Or myKeycode = 191 Or myKeycode = 220 Then
            RaiseEvent CheckSigma
        End If
        
        Select Case myKeycode
            'Markup constants
            Case 192 '`
                If (Shift And vbShiftMask) = vbShiftMask Then
                    If rtfMenuVisible And rtfMenu = grmDialyticaVaria Then
                        PrintUnicode Asc("~")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmDialyticaVaria
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                Else
                    If rtfMenuVisible And rtfMenu = grmVaria Then
                        PrintUnicode Asc("`")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmVaria
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                End If
                
            Case vbKey1
                If rtfMenuVisible And rtfMenu = grmDasiaOxia Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("!")
                    Else
                        PrintUnicode Asc("1")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmDasiaOxia
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case vbKey2
                If rtfMenuVisible And rtfMenu = grmDasiaVaria Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("@")
                    Else
                        PrintUnicode Asc("2")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmDasiaVaria
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case vbKey3
                If rtfMenuVisible And rtfMenu = grmDasiaPerispomeni Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("#")
                    Else
                        PrintUnicode Asc("3")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmDasiaPerispomeni
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case vbKey8
                If rtfMenuVisible And rtfMenu = grmPsiliOxia Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("*")
                    Else
                        PrintUnicode Asc("8")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmPsiliOxia
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case vbKey9
                If rtfMenuVisible And rtfMenu = grmPsiliVaria Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("(")
                    Else
                        PrintUnicode Asc("9")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmPsiliVaria
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case vbKey0
                If rtfMenuVisible And rtfMenu = grmPsiliPerispomeni Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc(")")
                    Else
                        PrintUnicode Asc("0")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmPsiliPerispomeni
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case 219 '[
                If rtfMenuVisible And rtfMenu = grmDasia Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("{")
                    Else
                        PrintUnicode Asc("[")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmDasia
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case 221 ']
                If rtfMenuVisible And rtfMenu = grmPsili Then
                    If (Shift And vbShiftMask) = vbShiftMask Then
                        PrintUnicode Asc("}")
                    Else
                        PrintUnicode Asc("]")
                    End If
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                Else
                    rtfMarkup = grmPsili
                    rtfStyle = rtfLower
                    DoMarkupMenu rtfMarkup
                    KeyCode = 0
                End If
                
            Case 222 ''
                If (Shift And vbShiftMask) = vbShiftMask Then
                    If rtfMenuVisible And rtfMenu = grmDialyticaOxia Then
                        PrintUnicode 34 ' "
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmDialyticaOxia
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                Else
                    If rtfMenuVisible And rtfMenu = grmOxia Then
                        PrintUnicode Asc("'")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmOxia
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                End If
                
            Case 187 '=
                If (Shift And vbShiftMask) = vbShiftMask Then
                    If rtfMenuVisible And rtfMenu = grmDialyticaPerispomeni Then
                        PrintUnicode Asc("+")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmDialyticaPerispomeni
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                Else
                    If rtfMenuVisible And rtfMenu = grmPerispomeni Then
                        PrintUnicode Asc("=")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmPerispomeni
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                End If
            
            Case 189 '-
                If (Shift And vbShiftMask) = vbShiftMask Then
                    If rtfMenuVisible And rtfMenu = grmVrachy Then
                        PrintUnicode Asc("_")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmVrachy
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                Else
                    If rtfMenuVisible And rtfMenu = grmMacron Then
                        PrintUnicode Asc("-")
                        rtfMarkup = grmNothing
                        rtfStyle = rtfLower
                        HideMenu
                    Else
                        rtfMarkup = grmMacron
                        rtfStyle = rtfLower
                        DoMarkupMenu rtfMarkup
                        KeyCode = 0
                    End If
                End If
            Case vbKeyShift
                If Not rtfMenuShift Then
                    rtfMenuShift = True
                    If rtfMenuVisible Then
                        ShowMenu rtfMenu, rtfMenuSub
                    End If
                End If
            Case vbKeyEscape
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
                HideMenu
            Case vbKeyBack
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
                HideMenu
            Case vbKeyDelete
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
                HideMenu
            Case 18
                'alt
                If Not rtfMenuAlt And (Shift And vbAltMask) = vbAltMask And (Shift And vbCtrlMask) = vbCtrlMask Then
                    rtfMenuAlt = True
                    If rtfMenuVisible Then
                        ShowMenu rtfMenu, rtfMenuSub
                    End If
                End If
            Case 186 ';    quick hack
                If (Shift And vbShiftMask) = vbShiftMask Then
                    PrintUnicode 903
                    rtfMarkup = grmNothing
                    rtfStyle = rtfLower
                    HideMenu
                End If
            Case Else
                rtfMarkup = grmNothing
                rtfStyle = rtfLower
        End Select
    End If
End Sub

'WARNING! DO NOT REMOVE OR MODIFY THE FOLLOWING COMMENTED LINES!
'MemberInfo=14
Public Sub RTFKeyUp(ByRef KeyCode As Integer, ByRef Shift As Integer)
Attribute RTFKeyUp.VB_Description = "Pass through KeyUp event of RichTextBox."
    Dim myKeycode As Integer
    
    myKeycode = KeyCode
    
    If myKeycode = vbKeyShift And rtfMenuShift Then
        rtfMenuShift = False
        If rtfMenuVisible Then
            ShowMenu rtfMenu, rtfMenuSub
        End If
    ElseIf myKeycode = 18 And rtfMenuAlt Then
        rtfMenuAlt = False
        If rtfMenuVisible Then
            If rtfMenu = -1 Then
                ShowMenu 0, rtfMenuSub
            Else
                ShowMenu rtfMenu, rtfMenuSub
            End If
        End If
    End If
End Sub

'Initialize Properties for User Control
Private Sub UserControl_InitProperties()
    m_ForeColor = m_def_ForeColor
End Sub

'Load property values from storage
Private Sub UserControl_ReadProperties(PropBag As PropertyBag)
    UserControl.BackColor = PropBag.ReadProperty("BackColor", &H8000000F)
    m_ForeColor = PropBag.ReadProperty("ForeColor", m_def_ForeColor)
    UserControl.Enabled = PropBag.ReadProperty("Enabled", True)
    UserControl.BackStyle = PropBag.ReadProperty("BackStyle", 0)
    UserControl.BorderStyle = PropBag.ReadProperty("BorderStyle", 0)
End Sub

'Write property values to storage
Private Sub UserControl_WriteProperties(PropBag As PropertyBag)
    Call PropBag.WriteProperty("BackColor", UserControl.BackColor, &H8000000F)
    Call PropBag.WriteProperty("ForeColor", m_ForeColor, m_def_ForeColor)
    Call PropBag.WriteProperty("Enabled", UserControl.Enabled, True)
    Call PropBag.WriteProperty("BackStyle", UserControl.BackStyle, 0)
    Call PropBag.WriteProperty("BorderStyle", UserControl.BorderStyle, 0)
End Sub

Sub PrintUnicode(UnicodeNumber As Integer, Optional myRTFIndex As Integer = -1)
    If myRTFIndex = -2 Then
        ShowMenu UnicodeNumber, 0
    ElseIf myRTFIndex < 0 Or myRTFIndex > 40 Then
        If UnicodeNumber < 128 Then
            RaiseEvent ChangeRTF("{\rtf1\ansi\ansicpg1252\deff0\uc1\pard\lang1032 " & IIf(UnicodeNumber = 123 Or UnicodeNumber = 125, "\", "") & Chr$(UnicodeNumber) & "}")
        Else
            RaiseEvent ChangeRTF("{\rtf1\ansi\ansicpg1252\deff0\uc1\pard\lang1032\u" & UnicodeNumber & "?}")
        End If
    Else
        If UnicodeNumber > 0 Then
            If UnicodeNumber < 256 Then
                myRTF_CacheRTF(myRTFIndex) = "{\rtf1\ansi\ansicpg1252\deff0\uc1\pard\lang1032 " & IIf(UnicodeNumber = 123 Or UnicodeNumber = 125, "\", "") & Chr$(UnicodeNumber) & "}"
            Else
                myRTF_CacheRTF(myRTFIndex) = "{\rtf1\ansi\ansicpg1252\deff0\uc1\pard\lang1032\u" & UnicodeNumber & "?}"
            End If
        Else
            myRTF_CacheRTF(myRTFIndex) = ""
        End If
        myRTF_CacheTag(myRTFIndex) = UnicodeNumber
    End If
End Sub

Sub PrintLetter(myKeycode As Integer, myMarkup As rtfMarkupConstants, myStyle As rtfStyleConstants, Optional myRTFIndex As Integer = -1)
    If rtfKeyboard = kbdLatin Then
        Select Case myKeycode
            'letters
            Case vbKeyA
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("a"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 225, myRTFIndex
                        Case lamGrave
                            PrintUnicode 224, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 226, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 228, myRTFIndex
                        Case lamTilde
                            PrintUnicode 227, myRTFIndex
                        Case lamMacron
                            PrintUnicode 257, myRTFIndex
                        Case lamBreve
                            PrintUnicode 259, myRTFIndex
                        Case lamRing
                            PrintUnicode 229, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("a"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 261, myRTFIndex
                        Case lamCaron
                            PrintUnicode 462, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 551, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7841, myRTFIndex
                        Case lamLigature
                            PrintUnicode 230, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("A"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 193, myRTFIndex
                        Case lamGrave
                            PrintUnicode 192, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 194, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 196, myRTFIndex
                        Case lamTilde
                            PrintUnicode 195, myRTFIndex
                        Case lamMacron
                            PrintUnicode 256, myRTFIndex
                        Case lamBreve
                            PrintUnicode 258, myRTFIndex
                        Case lamRing
                            PrintUnicode 197, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("A"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 260, myRTFIndex
                        Case lamCaron
                            PrintUnicode 461, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 550, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7840, myRTFIndex
                        Case lamLigature
                            PrintUnicode 198, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 507, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 506, myRTFIndex
                End If
            Case vbKeyB
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("b"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7683, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7685, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("b"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("B"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7682, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7684, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("B"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode Asc("b"), myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode Asc("B"), myRTFIndex
                End If
            Case vbKeyC
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 263, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 265, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 231, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 269, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 267, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("c"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("c"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 262, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 264, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 199, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 268, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 266, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("C"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("C"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 169, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 162, myRTFIndex
                End If
            Case vbKeyD
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 273, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 7697, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("d"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7691, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7693, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("d"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 272, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 7696, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("D"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 270, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7690, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7692, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("D"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 240, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 272, myRTFIndex
                End If
            Case vbKeyE
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("e"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 233, myRTFIndex
                        Case lamGrave
                            PrintUnicode 232, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 234, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 235, myRTFIndex
                        Case lamTilde
                            PrintUnicode 7869, myRTFIndex
                        Case lamMacron
                            PrintUnicode 275, myRTFIndex
                        Case lamBreve
                            PrintUnicode 277, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("e"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 553, myRTFIndex
                        Case lamOgonek
                            PrintUnicode 281, myRTFIndex
                        Case lamCaron
                            PrintUnicode 283, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 279, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7865, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("e"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("E"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 201, myRTFIndex
                        Case lamGrave
                            PrintUnicode 200, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 202, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 203, myRTFIndex
                        Case lamTilde
                            PrintUnicode 7868, myRTFIndex
                        Case lamMacron
                            PrintUnicode 274, myRTFIndex
                        Case lamBreve
                            PrintUnicode 276, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("E"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 552, myRTFIndex
                        Case lamOgonek
                            PrintUnicode 280, myRTFIndex
                        Case lamCaron
                            PrintUnicode 282, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 278, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7864, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("E"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 601, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 399, myRTFIndex
                End If
            Case vbKeyF
                If myStyle = rtfLower Then
                    PrintUnicode Asc("f"), myRTFIndex
                ElseIf myStyle = rtfUpper Then
                    If myMarkup = lamDotAbove Then
                        PrintUnicode 7710, myRTFIndex
                    Else
                        PrintUnicode Asc("F"), myRTFIndex
                    End If
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 402, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 402, myRTFIndex
                End If
            Case vbKeyG
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 501, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 285, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 7713, myRTFIndex
                        Case lamBreve
                            PrintUnicode 287, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 291, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 487, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 289, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("g"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("g"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 500, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 284, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 7712, myRTFIndex
                        Case lamBreve
                            PrintUnicode 286, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 290, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 486, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 288, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("G"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("G"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 509, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 508, myRTFIndex
                End If
            Case vbKeyH
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 295, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 7721, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("h"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7715, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7717, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("h"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 292, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 294, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 7720, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("H"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 542, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7714, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7716, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("H"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 483, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 482, myRTFIndex
                End If
            Case vbKeyI
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("i"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 237, myRTFIndex
                        Case lamGrave
                            PrintUnicode 236, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 238, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 239, myRTFIndex
                        Case lamTilde
                            PrintUnicode 297, myRTFIndex
                        Case lamMacron
                            PrintUnicode 299, myRTFIndex
                        Case lamBreve
                            PrintUnicode 301, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("i"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("i"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 303, myRTFIndex
                        Case lamCaron
                            PrintUnicode 464, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 305, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7883, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("i"), myRTFIndex
                            PrintUnicode Asc("j"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("I"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 205, myRTFIndex
                        Case lamGrave
                            PrintUnicode 204, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 206, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 207, myRTFIndex
                        Case lamTilde
                            PrintUnicode 296, myRTFIndex
                        Case lamMacron
                            PrintUnicode 298, myRTFIndex
                        Case lamBreve
                            PrintUnicode 300, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("I"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("I"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 302, myRTFIndex
                        Case lamCaron
                            PrintUnicode 463, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 304, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7882, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("I"), myRTFIndex
                            PrintUnicode Asc("J"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 305, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode Asc("I"), myRTFIndex
                End If
            Case vbKeyJ
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 309, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 496, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("j"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("i"), myRTFIndex
                            PrintUnicode Asc("j"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 308, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("J"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("I"), myRTFIndex
                            PrintUnicode Asc("J"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 511, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 510, myRTFIndex
                End If
            Case vbKeyK
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 311, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("k"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7731, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("k"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7728, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 310, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 488, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("K"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7730, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("K"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 312, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode Asc("K"), myRTFIndex
                End If
            Case vbKeyL
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 322, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 316, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("l"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7735, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("l"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 313, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 321, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 315, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("L"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7734, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("L"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 320, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 319, myRTFIndex
                End If
            Case vbKeyM
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7743, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("m"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7745, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7747, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("m"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7742, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("M"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7744, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7746, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("M"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 181, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 181, myRTFIndex
                End If
            Case vbKeyN
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 324, myRTFIndex
                        Case lamGrave
                            PrintUnicode 505, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamTilde
                            PrintUnicode 241, myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 326, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("n"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 328, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7749, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7751, myRTFIndex
                        Case lamLigature
                            PrintUnicode 331, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 323, myRTFIndex
                        Case lamGrave
                            PrintUnicode 504, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamTilde
                            PrintUnicode 209, myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 325, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("N"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 327, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7748, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7750, myRTFIndex
                        Case lamLigature
                            PrintUnicode 330, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 329, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 329, myRTFIndex
                End If
            Case vbKeyO
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("o"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 243, myRTFIndex
                        Case lamGrave
                            PrintUnicode 242, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 244, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 246, myRTFIndex
                        Case lamTilde
                            PrintUnicode 245, myRTFIndex
                        Case lamMacron
                            PrintUnicode 333, myRTFIndex
                        Case lamBreve
                            PrintUnicode 335, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("o"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("o"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 491, myRTFIndex
                        Case lamCaron
                            PrintUnicode 466, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 559, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7885, myRTFIndex
                        Case lamLigature
                            PrintUnicode 339, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("O"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 211, myRTFIndex
                        Case lamGrave
                            PrintUnicode 210, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 212, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 214, myRTFIndex
                        Case lamTilde
                            PrintUnicode 213, myRTFIndex
                        Case lamMacron
                            PrintUnicode 332, myRTFIndex
                        Case lamBreve
                            PrintUnicode 334, myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("O"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("O"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 490, myRTFIndex
                        Case lamCaron
                            PrintUnicode 465, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 558, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7884, myRTFIndex
                        Case lamLigature
                            PrintUnicode 338, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 337, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 336, myRTFIndex
                End If
            Case vbKeyP
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7765, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7767, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("p"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("p"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7764, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7766, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("P"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("P"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 182, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 167, myRTFIndex
                End If
            Case vbKeyQ
                If myStyle = rtfLower Then
                    PrintUnicode Asc("q"), myRTFIndex
                ElseIf myStyle = rtfUpper Then
                    PrintUnicode Asc("Q"), myRTFIndex
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 493, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 492, myRTFIndex
                End If
            Case vbKeyR
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 341, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 343, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("r"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 345, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7769, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7771, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("r"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 340, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 342, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("R"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 344, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7768, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7770, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("R"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 174, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 174, myRTFIndex
                End If
            Case vbKeyS
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 347, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 349, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 351, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("s"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 353, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7777, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7779, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("s"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 346, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 348, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 350, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("S"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 352, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7776, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7778, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("S"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 223, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 383, myRTFIndex
                End If
            Case vbKeyT
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 359, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 355, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("t"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7787, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7789, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("t"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 358, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode 354, myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("T"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 356, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7786, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7788, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("T"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 254, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 222, myRTFIndex
                End If
            Case vbKeyU
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("u"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 250, myRTFIndex
                        Case lamGrave
                            PrintUnicode 249, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 251, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 252, myRTFIndex
                        Case lamTilde
                            PrintUnicode 361, myRTFIndex
                        Case lamMacron
                            PrintUnicode 363, myRTFIndex
                        Case lamBreve
                            PrintUnicode 365, myRTFIndex
                        Case lamRing
                            PrintUnicode 367, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("u"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 371, myRTFIndex
                        Case lamCaron
                            PrintUnicode 468, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("u"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7909, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("u"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("U"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 218, myRTFIndex
                        Case lamGrave
                            PrintUnicode 217, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 219, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 220, myRTFIndex
                        Case lamTilde
                            PrintUnicode 360, myRTFIndex
                        Case lamMacron
                            PrintUnicode 362, myRTFIndex
                        Case lamBreve
                            PrintUnicode 364, myRTFIndex
                        Case lamRing
                            PrintUnicode 366, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("U"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode 370, myRTFIndex
                        Case lamCaron
                            PrintUnicode 467, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("U"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7908, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("U"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 369, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 368, myRTFIndex
                End If
            Case vbKeyV
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamTilde
                            PrintUnicode 7805, myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("v"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7807, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("v"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamTilde
                            PrintUnicode 7804, myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode Asc("V"), myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7806, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("V"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode Asc("v"), myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode Asc("V"), myRTFIndex
                End If
            Case vbKeyW
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7811, myRTFIndex
                        Case lamGrave
                            PrintUnicode 7809, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 373, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 7813, myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamRing
                            PrintUnicode 7832, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("w"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7815, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7817, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("w"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 7810, myRTFIndex
                        Case lamGrave
                            PrintUnicode 7808, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 372, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 7812, myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("W"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7814, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7816, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("W"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 447, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 503, myRTFIndex
                End If
            Case vbKeyX
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 7821, myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7819, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("x"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("x"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamAcute
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 7820, myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamMacron
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7818, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode Asc("X"), myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("X"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode Asc("x"), myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode Asc("X"), myRTFIndex
                End If
            Case vbKeyY
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("y"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 253, myRTFIndex
                        Case lamGrave
                            PrintUnicode 7923, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 375, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 255, myRTFIndex
                        Case lamTilde
                            PrintUnicode 7929, myRTFIndex
                        Case lamMacron
                            PrintUnicode 563, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("y"), myRTFIndex
                        Case lamRing
                            PrintUnicode 7833, myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("y"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("y"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("y"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7823, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7925, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("i"), myRTFIndex
                            PrintUnicode Asc("j"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 221, myRTFIndex
                        Case lamGrave
                            PrintUnicode 7922, myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 374, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode 376, myRTFIndex
                        Case lamTilde
                            PrintUnicode 7928, myRTFIndex
                        Case lamMacron
                            PrintUnicode 562, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamCaron
                            PrintUnicode Asc("Y"), myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 7822, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7924, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("I"), myRTFIndex
                            PrintUnicode Asc("J"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 541, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 540, myRTFIndex
                End If
            Case vbKeyZ
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 378, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 7825, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 438, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("z"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 382, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 380, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7827, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("z"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Then
                    Select Case myMarkup
                        Case lamNothing
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamAcute
                            PrintUnicode 377, myRTFIndex
                        Case lamGrave
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamCircumflex
                            PrintUnicode 7824, myRTFIndex
                        Case lamDiaresis
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamTilde
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamMacron
                            PrintUnicode 437, myRTFIndex
                        Case lamBreve
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamRing
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamCedilla
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamOgonek
                            PrintUnicode Asc("Z"), myRTFIndex
                        Case lamCaron
                            PrintUnicode 381, myRTFIndex
                        Case lamDotAbove
                            PrintUnicode 379, myRTFIndex
                        Case lamDotBelow
                            PrintUnicode 7826, myRTFIndex
                        Case lamLigature
                            PrintUnicode Asc("Z"), myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    PrintUnicode 658, myRTFIndex
                ElseIf myStyle = rtfUpperAlt Then
                    PrintUnicode 439, myRTFIndex
                End If
            Case vbKeySpace
                Select Case myMarkup
                    Case lamNothing
                        PrintUnicode Asc(" "), myRTFIndex
                    Case lamAcute
                        PrintUnicode 180, myRTFIndex
                    Case lamGrave
                        PrintUnicode 96, myRTFIndex
                    Case lamCircumflex
                        PrintUnicode Asc("^"), myRTFIndex
                    Case lamDiaresis
                        PrintUnicode 168, myRTFIndex
                    Case lamTilde
                        PrintUnicode Asc("~"), myRTFIndex
                    Case lamMacron
                        PrintUnicode 175, myRTFIndex
                    Case lamBreve
                        PrintUnicode 728, myRTFIndex
                    Case lamRing
                        PrintUnicode 176, myRTFIndex
                    Case lamCedilla
                        PrintUnicode 184, myRTFIndex
                    Case lamOgonek
                        PrintUnicode 731, myRTFIndex
                    Case lamCaron
                        PrintUnicode 711, myRTFIndex
                    Case lamDotAbove
                        PrintUnicode 729, myRTFIndex
                    Case lamDotBelow
                        PrintUnicode Asc("."), myRTFIndex
                    Case lamLigature
                        PrintUnicode Asc(" "), myRTFIndex
                End Select
        End Select
    
    ElseIf rtfKeyboard = kbdGreek Then
        Select Case myKeycode
            'letters
            Case vbKeyA
                'alpha
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 945, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7936, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7937, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7938, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7939, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7940, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7941, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7942, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7943, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8048, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8049, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8118, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8112, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8113, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8048, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8049, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8118, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 913, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7944, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7945, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7946, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7947, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7948, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7949, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7950, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7951, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8122, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8123, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8121, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8120, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8121, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8122, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8123, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8121, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 8115, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8064, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8065, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8066, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8067, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8068, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8069, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8070, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8071, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8114, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8116, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8119, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8119, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8119, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8114, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8116, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8119, myRTFIndex
                    End Select
                End If
                
                If myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyB
                'beta
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 946, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 914, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 946, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 914, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyC
                'psi
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 968, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 936, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 968, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 936, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyD
                'delta
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 948, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 916, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 948, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 916, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyE
                'epsilon
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 949, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7952, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7953, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7954, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7955, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7956, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7957, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7952, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7953, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8050, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8051, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 949, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 949, myRTFIndex
                        Case grmMacron
                            PrintUnicode 949, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8050, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8051, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 949, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 917, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7960, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7961, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7962, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7963, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7964, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7965, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7960, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7961, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8136, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8137, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 917, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 917, myRTFIndex
                        Case grmMacron
                            PrintUnicode 917, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8136, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8137, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 917, myRTFIndex
                    End Select
                End If
            
                If myStyle = rtfLowerAlt Or myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyF
                'fi
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 966, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 934, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 966, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 934, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyG
                'gamma
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 947, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 915, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 947, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 915, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyH
                'eta
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 951, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7968, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7969, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7970, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7971, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7972, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7973, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7974, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7975, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8052, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8053, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8134, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8134, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8134, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8052, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8053, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8134, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 919, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7976, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7977, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7978, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7979, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7980, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7981, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7982, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7983, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8138, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8139, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 919, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 919, myRTFIndex
                        Case grmMacron
                            PrintUnicode 919, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8138, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8139, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 919, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 8131, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8080, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8081, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8082, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8083, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8084, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8085, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8086, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8087, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8130, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8132, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8135, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8135, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8135, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8130, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8131, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8135, myRTFIndex
                    End Select
                End If
                
                If myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyI
                'iota
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 953, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7984, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7985, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7986, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7987, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7988, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7989, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7990, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7991, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8054, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8055, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8150, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8144, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8145, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8146, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8147, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8151, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 921, myRTFIndex
                        Case grmPsili
                            PrintUnicode 7992, myRTFIndex
                        Case grmDasia
                            PrintUnicode 7993, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 7994, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 7995, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 7996, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 7997, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 7998, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 7999, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8154, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8155, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8153, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8152, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8153, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8154, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8155, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8153, myRTFIndex
                    End Select
                End If
            
                If myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyJ
                'ksi
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 958, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 926, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 958, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 926, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyK
                'kappa
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 954, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 922, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 954, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 922, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyL
                'labda
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 955, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 923, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 955, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 923, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyM
                'mu
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 956, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 924, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 956, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 924, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyN
                'nu
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 957, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 925, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 957, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 925, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyO
                'omikron
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 959, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8000, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8001, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8002, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8003, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8004, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8005, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8000, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8001, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8056, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8057, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 959, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 959, myRTFIndex
                        Case grmMacron
                            PrintUnicode 959, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8056, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8057, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8058, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 927, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8008, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8009, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8010, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8011, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8012, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8013, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8008, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8009, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8184, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8185, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 927, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 927, myRTFIndex
                        Case grmMacron
                            PrintUnicode 927, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8184, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8185, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 927, myRTFIndex
                    End Select
                End If
            
                If myStyle = rtfLowerAlt Or myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyP
                'pi
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 960, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 928, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 960, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 928, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyQ
                'theta
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 952, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 920, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 959, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 920, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyR
                'rho
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    If myMarkup = grmPsili Then
                        PrintUnicode 8164, myRTFIndex
                    ElseIf myMarkup = grmDasia Then
                        PrintUnicode 8165, myRTFIndex
                    Else
                        PrintUnicode 961, myRTFIndex
                    End If
                Else
                    If myMarkup = grmDasia Then
                        PrintUnicode 8172, myRTFIndex
                    Else
                        PrintUnicode 929, myRTFIndex
                    End If
                End If
                
                If myStyle = rtfLowerAlt Or myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyS
                'sigma
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 963, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 931, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 963, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 931, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyT
                'tau
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 964, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 932, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 964, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 932, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyU
                'upsilon
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 965, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8016, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8017, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8018, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8019, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8020, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8021, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8022, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8023, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8058, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8059, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8166, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8160, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8161, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8162, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8163, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8167, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 933, myRTFIndex
                        Case grmPsili
                            PrintUnicode 933, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8025, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8027, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8029, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8169, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8031, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8169, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8168, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8169, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8169, myRTFIndex
                    End Select
                End If
            
                If myStyle = rtfLowerAlt Or myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyV
                'eind sigma
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 962, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 931, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 962, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 931, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyW
                'omega
                If myStyle = rtfLower Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 969, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8032, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8033, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8034, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8035, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8036, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8037, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8038, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8039, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8060, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8061, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8182, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8182, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8182, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8060, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8061, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8182, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 937, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8040, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8041, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8042, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8043, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8044, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8045, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8046, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8047, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8186, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8187, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 937, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 937, myRTFIndex
                        Case grmMacron
                            PrintUnicode 937, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8186, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8187, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 937, myRTFIndex
                    End Select
                ElseIf myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 8179, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8096, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8097, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8098, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8099, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8100, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8101, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8102, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8103, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8178, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8180, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8183, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8183, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8183, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8178, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8180, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8183, myRTFIndex
                    End Select
                End If
                
                If myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyX
                'chi
                Select Case myStyle
                    Case rtfLower
                        PrintUnicode 967, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 935, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 967, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 935, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeyY
                'upsilon
                If myStyle = rtfLower Or myStyle = rtfLowerAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 965, myRTFIndex
                        Case grmPsili
                            PrintUnicode 8016, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8017, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8018, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8019, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8020, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8021, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8022, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8023, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8058, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8059, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8166, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8160, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8161, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8162, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8163, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8167, myRTFIndex
                    End Select
                ElseIf myStyle = rtfUpper Or myStyle = rtfUpperAlt Then
                    Select Case myMarkup
                        Case grmNothing
                            PrintUnicode 933, myRTFIndex
                        Case grmPsili
                            PrintUnicode 933, myRTFIndex
                        Case grmDasia
                            PrintUnicode 8025, myRTFIndex
                        Case grmPsiliVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmDasiaVaria
                            PrintUnicode 8027, myRTFIndex
                        Case grmPsiliOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmDasiaOxia
                            PrintUnicode 8029, myRTFIndex
                        Case grmPsiliPerispomeni
                            PrintUnicode 8169, myRTFIndex
                        Case grmDasiaPerispomeni
                            PrintUnicode 8031, myRTFIndex
                        Case grmVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmPerispomeni
                            PrintUnicode 8169, myRTFIndex
                        Case grmVrachy
                            PrintUnicode 8168, myRTFIndex
                        Case grmMacron
                            PrintUnicode 8169, myRTFIndex
                        Case grmDialyticaVaria
                            PrintUnicode 8170, myRTFIndex
                        Case grmDialyticaOxia
                            PrintUnicode 8171, myRTFIndex
                        Case grmDialyticaPerispomeni
                            PrintUnicode 8169, myRTFIndex
                    End Select
                End If
            
                If myStyle = rtfLowerAlt Or myStyle = rtfUpperAlt Then
                    PrintUnicode 8126, myRTFIndex
                End If
            Case vbKeyZ
                'zeta
                Select Case rtfStyle
                    Case rtfLower
                        PrintUnicode 950, myRTFIndex
                    Case rtfUpper
                        PrintUnicode 918, myRTFIndex
                    Case rtfLowerAlt
                        PrintUnicode 950, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                    Case rtfUpperAlt
                        PrintUnicode 918, myRTFIndex
                        PrintUnicode 8126, myRTFIndex
                End Select
            Case vbKeySpace
                Select Case rtfMarkup
                    Case grmPsili
                        PrintUnicode 8127, myRTFIndex
                    Case grmDasia
                        PrintUnicode 8190, myRTFIndex
                    Case grmPsiliVaria
                        PrintUnicode 8141, myRTFIndex
                    Case grmDasiaVaria
                        PrintUnicode 8157, myRTFIndex
                    Case grmPsiliOxia
                        PrintUnicode 8142, myRTFIndex
                    Case grmDasiaOxia
                        PrintUnicode 8158, myRTFIndex
                    Case grmPsiliPerispomeni
                        PrintUnicode 8143, myRTFIndex
                    Case grmDasiaPerispomeni
                        PrintUnicode 8159, myRTFIndex
                    Case grmVaria
                        PrintUnicode 8175, myRTFIndex
                    Case grmOxia
                        PrintUnicode 8189, myRTFIndex
                    Case grmPerispomeni
                        PrintUnicode 8128, myRTFIndex
                    Case grmDialyticaVaria
                        PrintUnicode 8173, myRTFIndex
                    Case grmDialyticaOxia
                        PrintUnicode 8174, myRTFIndex
                    Case grmDialyticaPerispomeni
                        PrintUnicode 8129, myRTFIndex
                End Select
        End Select
    End If
End Sub

Public Sub Refresh()
    Dim i As Integer
    
    For i = 0 To 14
        myRTF(i).SelStart = 0
        myRTF(i).SelLength = 1
        myRTF(i).SelAlignment = rtfCenter
    Next i
End Sub

Public Sub ShowMenu(myMenu As Integer, myMenuSub As Integer)
    Dim i As Integer
    Dim SubMenu As Integer
    Dim j As Integer
    Dim k As Integer
    Dim myLeft As Integer
    Dim myTop As Integer
    
    rtfMenu = myMenu
    rtfMenuSub = myMenuSub
    rtfMenuVisible = True
    
    For i = 0 To 40
        PrintUnicode 0, i
    Next i
    For i = 0 To 14
        myRTF(i).Text = ""
        myRTF(i).Tag = 0
    Next i
    
    i = 0

    If rtfKeyboard = kbdLatin Then
        Select Case rtfMenu
            Case 0
                For i = vbKeyA To vbKeyZ
                    PrintLetter i, lamNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i - vbKeyA
                Next i
            Case -1
                For i = vbKeyA To vbKeyZ
                    PrintLetter i, lamNothing, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i - vbKeyA
                Next i
            Case Asc("a")
                For i = 0 To 8
                    PrintLetter vbKeyA, CVar(i), rtfLower, i
                Next i
                For i = 10 To 14
                    PrintLetter vbKeyA, CVar(i), rtfLower, i - 1
                Next i
                PrintLetter vbKeyG, lamNothing, rtfLowerAlt, 14
                PrintLetter vbKeyH, lamNothing, rtfLowerAlt, 15
                PrintLetter vbKeyA, lamNothing, rtfLowerAlt, 16
            Case Asc("A")
                For i = 0 To 8
                    PrintLetter vbKeyA, CVar(i), rtfUpper, i
                Next i
                For i = 10 To 14
                    PrintLetter vbKeyA, CVar(i), rtfUpper, i - 1
                Next i
                PrintLetter vbKeyG, lamNothing, rtfUpperAlt, 14
                PrintLetter vbKeyH, lamNothing, rtfUpperAlt, 15
                PrintLetter vbKeyA, lamNothing, rtfUpperAlt, 16
            Case Asc("b")
                PrintLetter vbKeyB, lamNothing, rtfLower, 0
                PrintLetter vbKeyB, lamDotAbove, rtfLower, 1
                PrintLetter vbKeyB, lamDotBelow, rtfLower, 2
            Case Asc("B")
                PrintLetter vbKeyB, lamNothing, rtfUpper, 0
                PrintLetter vbKeyB, lamDotAbove, rtfUpper, 1
                PrintLetter vbKeyB, lamDotBelow, rtfUpper, 2
            Case Asc("c")
                PrintLetter vbKeyC, lamNothing, rtfLower, 0
                PrintLetter vbKeyC, lamAcute, rtfLower, 1
                PrintLetter vbKeyC, lamCircumflex, rtfLower, 2
                PrintLetter vbKeyC, lamCedilla, rtfLower, 3
                PrintLetter vbKeyC, lamCaron, rtfLower, 4
                PrintLetter vbKeyC, lamDotAbove, rtfLower, 5
                PrintLetter vbKeyC, lamNothing, rtfLowerAlt, 6
            Case Asc("C")
                PrintLetter vbKeyC, lamNothing, rtfUpper, 0
                PrintLetter vbKeyC, lamAcute, rtfUpper, 1
                PrintLetter vbKeyC, lamCircumflex, rtfUpper, 2
                PrintLetter vbKeyC, lamCedilla, rtfUpper, 3
                PrintLetter vbKeyC, lamCaron, rtfUpper, 4
                PrintLetter vbKeyC, lamDotAbove, rtfUpper, 5
                PrintLetter vbKeyC, lamNothing, rtfUpperAlt, 6
            Case Asc("d")
                PrintLetter vbKeyD, lamNothing, rtfLower, 0
                PrintLetter vbKeyD, lamMacron, rtfLower, 1
                PrintLetter vbKeyD, lamCedilla, rtfLower, 2
                PrintLetter vbKeyD, lamDotAbove, rtfLower, 3
                PrintLetter vbKeyD, lamDotBelow, rtfLower, 4
                PrintLetter vbKeyD, lamNothing, rtfLowerAlt, 5
            Case Asc("D")
                PrintLetter vbKeyD, lamNothing, rtfUpper, 0
                PrintLetter vbKeyD, lamMacron, rtfUpper, 1
                PrintLetter vbKeyD, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyD, lamCaron, rtfUpper, 3
                PrintLetter vbKeyD, lamDotAbove, rtfUpper, 4
                PrintLetter vbKeyD, lamDotBelow, rtfUpper, 5
            Case Asc("e")
                For i = 0 To 7
                    PrintLetter vbKeyE, CVar(i), rtfLower, i
                Next i
                For i = 9 To 13
                    PrintLetter vbKeyE, CVar(i), rtfLower, i - 1
                Next i
                PrintLetter vbKeyE, lamNothing, rtfLowerAlt, 13
            Case Asc("E")
                For i = 0 To 7
                    PrintLetter vbKeyE, CVar(i), rtfUpper, i
                Next i
                For i = 9 To 13
                    PrintLetter vbKeyE, CVar(i), rtfUpper, i - 1
                Next i
                PrintLetter vbKeyE, lamNothing, rtfUpperAlt, 13
            Case Asc("f")
                PrintLetter vbKeyF, lamNothing, rtfLower, 0
                PrintLetter vbKeyF, lamNothing, rtfLowerAlt, 1
            Case Asc("F")
                PrintLetter vbKeyF, lamNothing, rtfUpper, 0
                PrintLetter vbKeyF, lamNothing, rtfUpperAlt, 1
            Case Asc("g")
                PrintLetter vbKeyG, lamNothing, rtfLower, 0
                PrintLetter vbKeyG, lamAcute, rtfLower, 1
                PrintLetter vbKeyG, lamCircumflex, rtfLower, 2
                PrintLetter vbKeyG, lamMacron, rtfLower, 3
                PrintLetter vbKeyG, lamBreve, rtfLower, 4
                PrintLetter vbKeyG, lamCedilla, rtfLower, 5
                PrintLetter vbKeyG, lamCaron, rtfLower, 6
                PrintLetter vbKeyG, lamDotAbove, rtfLower, 7
            Case Asc("G")
                PrintLetter vbKeyG, lamNothing, rtfUpper, 0
                PrintLetter vbKeyG, lamAcute, rtfUpper, 1
                PrintLetter vbKeyG, lamCircumflex, rtfUpper, 2
                PrintLetter vbKeyG, lamMacron, rtfUpper, 3
                PrintLetter vbKeyG, lamBreve, rtfUpper, 4
                PrintLetter vbKeyG, lamCedilla, rtfUpper, 5
                PrintLetter vbKeyG, lamCaron, rtfUpper, 6
                PrintLetter vbKeyG, lamDotAbove, rtfUpper, 7
            Case Asc("h")
                PrintLetter vbKeyH, lamNothing, rtfLower, 0
                PrintLetter vbKeyH, lamMacron, rtfLower, 1
                PrintLetter vbKeyH, lamCedilla, rtfLower, 2
                PrintLetter vbKeyH, lamDotAbove, rtfLower, 3
                PrintLetter vbKeyH, lamDotBelow, rtfLower, 4
            Case Asc("H")
                PrintLetter vbKeyH, lamNothing, rtfUpper, 0
                PrintLetter vbKeyH, lamCircumflex, rtfUpper, 1
                PrintLetter vbKeyH, lamMacron, rtfUpper, 2
                PrintLetter vbKeyH, lamCedilla, rtfUpper, 3
                PrintLetter vbKeyH, lamCaron, rtfUpper, 4
                PrintLetter vbKeyH, lamDotAbove, rtfUpper, 5
                PrintLetter vbKeyH, lamDotBelow, rtfUpper, 6
            Case Asc("i")
                For i = 0 To 7
                    PrintLetter vbKeyI, CVar(i), rtfLower, i
                Next i
                For i = 10 To 13
                    PrintLetter vbKeyI, CVar(i), rtfLower, i - 2
                Next i
            Case Asc("I")
                For i = 0 To 7
                    PrintLetter vbKeyI, CVar(i), rtfUpper, i
                Next i
                For i = 10 To 13
                    PrintLetter vbKeyI, CVar(i), rtfUpper, i - 2
                Next i
            Case Asc("j")
                PrintLetter vbKeyJ, lamNothing, rtfLower, 0
                PrintLetter vbKeyJ, lamCircumflex, rtfLower, 1
                PrintLetter vbKeyJ, lamCaron, rtfLower, 2
            Case Asc("J")
                PrintLetter vbKeyJ, lamNothing, rtfUpper, 0
                PrintLetter vbKeyJ, lamCircumflex, rtfUpper, 1
            Case Asc("k")
                PrintLetter vbKeyK, lamNothing, rtfLower, 0
                PrintLetter vbKeyK, lamCedilla, rtfLower, 1
                PrintLetter vbKeyK, lamDotBelow, rtfLower, 2
                PrintLetter vbKeyK, lamNothing, rtfLowerAlt, 3
            Case Asc("K")
                PrintLetter vbKeyK, lamNothing, rtfUpper, 0
                PrintLetter vbKeyK, lamAcute, rtfUpper, 1
                PrintLetter vbKeyK, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyK, lamCaron, rtfUpper, 3
                PrintLetter vbKeyK, lamDotBelow, rtfUpper, 4
            Case Asc("l")
                PrintLetter vbKeyL, lamNothing, rtfLower, 0
                PrintLetter vbKeyL, lamMacron, rtfLower, 1
                PrintLetter vbKeyL, lamCedilla, rtfLower, 2
                PrintLetter vbKeyL, lamDotBelow, rtfLower, 3
                PrintLetter vbKeyL, lamNothing, rtfLowerAlt, 4
            Case Asc("L")
                PrintLetter vbKeyL, lamNothing, rtfUpper, 0
                PrintLetter vbKeyL, lamAcute, rtfUpper, 1
                PrintLetter vbKeyL, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyL, lamDotBelow, rtfUpper, 3
                PrintLetter vbKeyL, lamNothing, rtfUpperAlt, 4
            Case Asc("m")
                PrintLetter vbKeyM, lamNothing, rtfLower, 0
                PrintLetter vbKeyM, lamAcute, rtfLower, 1
                PrintLetter vbKeyM, lamDotAbove, rtfLower, 2
                PrintLetter vbKeyM, lamDotBelow, rtfLower, 3
                PrintLetter vbKeyM, lamNothing, rtfLowerAlt, 4
            Case Asc("M")
                PrintLetter vbKeyM, lamNothing, rtfUpper, 0
                PrintLetter vbKeyM, lamAcute, rtfUpper, 1
                PrintLetter vbKeyM, lamDotAbove, rtfUpper, 2
                PrintLetter vbKeyM, lamDotBelow, rtfUpper, 3
            Case Asc("n")
                PrintLetter vbKeyN, lamNothing, rtfLower, 0
                PrintLetter vbKeyN, lamAcute, rtfLower, 1
                PrintLetter vbKeyN, lamGrave, rtfLower, 2
                PrintLetter vbKeyN, lamTilde, rtfLower, 3
                PrintLetter vbKeyN, lamCedilla, rtfLower, 4
                PrintLetter vbKeyN, lamCaron, rtfLower, 5
                PrintLetter vbKeyN, lamDotAbove, rtfLower, 6
                PrintLetter vbKeyN, lamDotBelow, rtfLower, 7
                PrintLetter vbKeyN, lamLigature, rtfLower, 8
                PrintLetter vbKeyN, lamNothing, rtfLowerAlt, 9
            Case Asc("N")
                PrintLetter vbKeyN, lamNothing, rtfUpper, 0
                PrintLetter vbKeyN, lamAcute, rtfUpper, 1
                PrintLetter vbKeyN, lamGrave, rtfUpper, 2
                PrintLetter vbKeyN, lamTilde, rtfUpper, 3
                PrintLetter vbKeyN, lamCedilla, rtfUpper, 4
                PrintLetter vbKeyN, lamCaron, rtfUpper, 5
                PrintLetter vbKeyN, lamDotAbove, rtfUpper, 6
                PrintLetter vbKeyN, lamDotBelow, rtfUpper, 7
                PrintLetter vbKeyN, lamLigature, rtfUpper, 8
            Case Asc("o")
                For i = 0 To 7
                    PrintLetter vbKeyO, CVar(i), rtfLower, i
                Next i
                For i = 10 To 14
                    PrintLetter vbKeyO, CVar(i), rtfLower, i - 2
                Next i
                PrintLetter vbKeyO, lamNothing, rtfLowerAlt, 13
                PrintLetter vbKeyJ, lamNothing, rtfLowerAlt, 14
                PrintLetter vbKeyQ, lamNothing, rtfLowerAlt, 15
            Case Asc("O")
                For i = 0 To 7
                    PrintLetter vbKeyO, CVar(i), rtfUpper, i
                Next i
                For i = 10 To 14
                    PrintLetter vbKeyO, CVar(i), rtfUpper, i - 2
                Next i
                PrintLetter vbKeyO, lamNothing, rtfUpperAlt, 13
                PrintLetter vbKeyJ, lamNothing, rtfUpperAlt, 14
                PrintLetter vbKeyQ, lamNothing, rtfUpperAlt, 15
            Case Asc("p")
                PrintLetter vbKeyP, lamNothing, rtfLower, 0
                PrintLetter vbKeyP, lamAcute, rtfLower, 1
                PrintLetter vbKeyP, lamDotAbove, rtfLower, 2
                PrintLetter vbKeyP, lamNothing, rtfLowerAlt, 3
            Case Asc("P")
                PrintLetter vbKeyP, lamNothing, rtfUpper, 0
                PrintLetter vbKeyP, lamAcute, rtfUpper, 1
                PrintLetter vbKeyP, lamDotAbove, rtfUpper, 2
                PrintLetter vbKeyP, lamNothing, rtfUpperAlt, 3
            Case Asc("q")
                PrintLetter vbKeyQ, lamNothing, rtfLower, 0
            Case Asc("Q")
                PrintLetter vbKeyQ, lamNothing, rtfUpper, 0
            Case Asc("r")
                PrintLetter vbKeyR, lamNothing, rtfLower, 0
                PrintLetter vbKeyR, lamAcute, rtfLower, 1
                PrintLetter vbKeyR, lamCedilla, rtfLower, 2
                PrintLetter vbKeyR, lamCaron, rtfLower, 3
                PrintLetter vbKeyR, lamDotAbove, rtfLower, 4
                PrintLetter vbKeyR, lamDotBelow, rtfLower, 5
                PrintLetter vbKeyR, lamNothing, rtfLowerAlt, 6
            Case Asc("R")
                PrintLetter vbKeyR, lamNothing, rtfUpper, 0
                PrintLetter vbKeyR, lamAcute, rtfUpper, 1
                PrintLetter vbKeyR, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyR, lamCaron, rtfUpper, 3
                PrintLetter vbKeyR, lamDotAbove, rtfUpper, 4
                PrintLetter vbKeyR, lamDotBelow, rtfUpper, 5
                PrintLetter vbKeyR, lamNothing, rtfUpperAlt, 6
            Case Asc("s")
                PrintLetter vbKeyS, lamNothing, rtfLower, 0
                PrintLetter vbKeyS, lamAcute, rtfLower, 1
                PrintLetter vbKeyS, lamCedilla, rtfLower, 2
                PrintLetter vbKeyS, lamCaron, rtfLower, 3
                PrintLetter vbKeyS, lamDotAbove, rtfLower, 4
                PrintLetter vbKeyS, lamDotBelow, rtfLower, 5
                PrintLetter vbKeyS, lamNothing, rtfLowerAlt, 6
            Case Asc("S")
                PrintLetter vbKeyS, lamNothing, rtfUpper, 0
                PrintLetter vbKeyS, lamAcute, rtfUpper, 1
                PrintLetter vbKeyS, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyS, lamCaron, rtfUpper, 3
                PrintLetter vbKeyS, lamDotAbove, rtfUpper, 4
                PrintLetter vbKeyS, lamDotBelow, rtfUpper, 5
                PrintLetter vbKeyS, lamNothing, rtfUpperAlt, 6
            Case Asc("t")
                PrintLetter vbKeyT, lamNothing, rtfLower, 0
                PrintLetter vbKeyT, lamMacron, rtfLower, 1
                PrintLetter vbKeyT, lamCedilla, rtfLower, 2
                PrintLetter vbKeyT, lamDotAbove, rtfLower, 3
                PrintLetter vbKeyT, lamDotBelow, rtfLower, 4
                PrintLetter vbKeyT, lamNothing, rtfLowerAlt, 5
            Case Asc("T")
                PrintLetter vbKeyT, lamNothing, rtfUpper, 0
                PrintLetter vbKeyT, lamMacron, rtfUpper, 1
                PrintLetter vbKeyT, lamCedilla, rtfUpper, 2
                PrintLetter vbKeyT, lamCaron, rtfUpper, 3
                PrintLetter vbKeyT, lamDotAbove, rtfUpper, 4
                PrintLetter vbKeyT, lamDotBelow, rtfUpper, 5
                PrintLetter vbKeyT, lamNothing, rtfUpperAlt, 6
            Case Asc("u")
                For i = 0 To 8
                    PrintLetter vbKeyU, CVar(i), rtfLower, i
                Next i
                PrintLetter vbKeyU, lamOgonek, rtfLower, 9
                PrintLetter vbKeyU, lamCaron, rtfLower, 10
                PrintLetter vbKeyU, lamDotBelow, rtfLower, 11
                PrintLetter vbKeyU, lamNothing, rtfLowerAlt, 12
            Case Asc("U")
                For i = 0 To 8
                    PrintLetter vbKeyU, CVar(i), rtfUpper, i
                Next i
                PrintLetter vbKeyU, lamOgonek, rtfUpper, 9
                PrintLetter vbKeyU, lamCaron, rtfUpper, 10
                PrintLetter vbKeyU, lamDotBelow, rtfUpper, 11
                PrintLetter vbKeyU, lamNothing, rtfUpperAlt, 12
            Case Asc("v")
                PrintLetter vbKeyV, lamNothing, rtfLower, 0
                PrintLetter vbKeyV, lamTilde, rtfLower, 1
                PrintLetter vbKeyV, lamDotBelow, rtfLower, 2
            Case Asc("V")
                PrintLetter vbKeyV, lamNothing, rtfUpper, 0
                PrintLetter vbKeyV, lamTilde, rtfUpper, 1
                PrintLetter vbKeyV, lamDotBelow, rtfUpper, 2
            Case Asc("w")
                For i = 0 To 4
                    PrintLetter vbKeyW, CVar(i), rtfLower, i
                Next i
                PrintLetter vbKeyW, lamRing, rtfLower, 5
                PrintLetter vbKeyW, lamDotAbove, rtfLower, 6
                PrintLetter vbKeyW, lamDotBelow, rtfLower, 7
                PrintLetter vbKeyW, lamNothing, rtfLowerAlt, 8
            Case Asc("W")
                For i = 0 To 4
                    PrintLetter vbKeyW, CVar(i), rtfUpper, i
                Next i
                PrintLetter vbKeyW, lamDotAbove, rtfUpper, 5
                PrintLetter vbKeyW, lamDotBelow, rtfUpper, 6
                PrintLetter vbKeyW, lamNothing, rtfUpperAlt, 7
            Case Asc("x")
                PrintLetter vbKeyX, lamNothing, rtfLower, 0
                PrintLetter vbKeyX, lamDiaresis, rtfLower, 1
                PrintLetter vbKeyX, lamDotAbove, rtfLower, 2
            Case Asc("X")
                PrintLetter vbKeyX, lamNothing, rtfUpper, 0
                PrintLetter vbKeyX, lamDiaresis, rtfUpper, 1
                PrintLetter vbKeyX, lamDotAbove, rtfUpper, 2
            Case Asc("y")
                For i = 0 To 6
                    PrintLetter vbKeyY, CVar(i), rtfLower, i
                Next i
                PrintLetter vbKeyY, lamRing, rtfLower, 7
                PrintLetter vbKeyY, lamDotAbove, rtfLower, 8
                PrintLetter vbKeyY, lamDotBelow, rtfLower, 9
            Case Asc("Y")
                For i = 0 To 6
                    PrintLetter vbKeyY, CVar(i), rtfUpper, i
                Next i
                PrintLetter vbKeyY, lamRing, rtfUpper, 7
                PrintLetter vbKeyY, lamDotAbove, rtfUpper, 8
                PrintLetter vbKeyY, lamDotBelow, rtfUpper, 9
            Case Asc("z")
                PrintLetter vbKeyZ, lamNothing, rtfLower, 0
                PrintLetter vbKeyZ, lamAcute, rtfLower, 1
                PrintLetter vbKeyZ, lamCircumflex, rtfLower, 2
                PrintLetter vbKeyZ, lamMacron, rtfLower, 3
                PrintLetter vbKeyZ, lamCaron, rtfLower, 4
                PrintLetter vbKeyZ, lamDotAbove, rtfLower, 5
                PrintLetter vbKeyZ, lamDotBelow, rtfLower, 6
            Case Asc("Z")
                PrintLetter vbKeyZ, lamNothing, rtfUpper, 0
                PrintLetter vbKeyZ, lamAcute, rtfUpper, 1
                PrintLetter vbKeyZ, lamCircumflex, rtfUpper, 2
                PrintLetter vbKeyZ, lamMacron, rtfUpper, 3
                PrintLetter vbKeyZ, lamCaron, rtfUpper, 4
                PrintLetter vbKeyZ, lamDotAbove, rtfUpper, 5
                PrintLetter vbKeyZ, lamDotBelow, rtfUpper, 6
            Case Else
                If rtfMenuAlt Then
                    For i = vbKeyA To vbKeyZ
                        PrintLetter i, rtfMarkup, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i - vbKeyA
                    Next i
                Else
                    If rtfMarkup = lamLigature Then
                        PrintLetter vbKeyA, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                        PrintLetter vbKeyO, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                        PrintLetter vbKeyN, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    Else
                        For i = vbKeyA To vbKeyZ
                            PrintLetter i, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i - vbKeyA
                        Next i
                        i = vbKeyZ - vbKeyA + 1
                        PrintLetter vbKeySpace, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                                        
                    If Not rtfMenuShift Then
                        Select Case rtfMenu
                            Case lamAcute
                                PrintUnicode Asc("'"), i
                            Case lamGrave
                                PrintUnicode Asc("`"), i
                            Case lamCircumflex
                            Case lamDiaresis
                                PrintUnicode Asc("'"), i
                            Case lamTilde
                            Case lamMacron
                                PrintUnicode Asc("-"), i
                            Case lamBreve
                            Case lamRing
                                PrintUnicode Asc("="), i
                            Case lamCedilla
                                PrintUnicode Asc(","), i
                            Case lamOgonek
                            Case lamCaron
                                PrintUnicode Asc("v"), i
                            Case lamDotAbove
                            Case lamDotBelow
                                PrintUnicode Asc("."), i
                            Case lamLigature
                        End Select
                    Else
                        Select Case rtfMenu
                            Case lamAcute
                            Case lamGrave
                            Case lamCircumflex
                                PrintUnicode Asc("^"), i
                            Case lamDiaresis
                                PrintUnicode 34, i
                            Case lamTilde
                                PrintUnicode Asc("~"), i
                            Case lamMacron
                            Case lamBreve
                                PrintUnicode Asc("_"), i
                            Case lamRing
                            Case lamCedilla
                            Case lamOgonek
                                PrintUnicode Asc("<"), i
                            Case lamCaron
                                PrintUnicode Asc("V"), i
                            Case lamDotAbove
                                PrintUnicode Asc(">"), i
                            Case lamDotBelow
                            Case lamLigature
                                PrintUnicode Asc("+"), i
                        End Select
                    End If
                End If
        End Select
    ElseIf rtfKeyboard = kbdGreek Then
        Select Case rtfMenu
            Case 0
                If rtfMenuAlt And Not rtfMenuShift Then
                    PrintLetter vbKeyA, grmNothing, rtfLowerAlt, i
                    i = i + 1
                    PrintLetter vbKeyH, grmNothing, rtfLowerAlt, i
                    i = i + 1
                    PrintLetter vbKeyW, grmNothing, rtfLowerAlt, i
                    i = i + 1
                Else
                    PrintLetter vbKeyA, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyA, grmNothing, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    PrintLetter vbKeyE, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyH, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyH, grmNothing, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    PrintLetter vbKeyI, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyO, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyR, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyS, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    PrintLetter vbKeyU, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyW, grmNothing, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyW, grmNothing, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                    End If
                End If
            Case 945
                For i = 0 To 13
                    PrintLetter vbKeyA, CVar(i), rtfLower, i
                Next i
            Case 913
                For i = 0 To 13
                    PrintLetter vbKeyA, CVar(i), rtfUpper, i
                Next i
            Case 8115
                For i = 0 To 11
                    PrintLetter vbKeyA, CVar(i), rtfLowerAlt, i
                Next i
            Case 949
                For i = 0 To 4
                    PrintLetter vbKeyE, CVar(i), rtfLower, i
                Next i
                For i = 6 To 7
                    PrintLetter vbKeyE, CVar(i), rtfLower, i - 1
                Next i
                For i = 9 To 10
                    PrintLetter vbKeyE, CVar(i), rtfLower, i - 2
                Next i
            Case 917
                For i = 0 To 4
                    PrintLetter vbKeyE, CVar(i), rtfUpper, i
                Next i
                For i = 6 To 7
                    PrintLetter vbKeyE, CVar(i), rtfUpper, i - 1
                Next i
                For i = 9 To 10
                    PrintLetter vbKeyE, CVar(i), rtfUpper, i - 2
                Next i
            Case 951
                For i = 0 To 11
                    PrintLetter vbKeyH, CVar(i), rtfLower, i
                Next i
            Case 919
                For i = 0 To 11
                    PrintLetter vbKeyH, CVar(i), rtfUpper, i
                Next i
            Case 8131
                For i = 0 To 11
                    PrintLetter vbKeyH, CVar(i), rtfLowerAlt, i
                Next i
            Case 953
                For i = 0 To 16
                    PrintLetter vbKeyI, CVar(i), rtfLower, i
                Next i
            Case 921
                For i = 0 To 13
                    PrintLetter vbKeyI, CVar(i), rtfUpper, i
                Next i
            Case 959
                For i = 0 To 4
                    PrintLetter vbKeyO, CVar(i), rtfLower, i
                Next i
                For i = 6 To 7
                    PrintLetter vbKeyO, CVar(i), rtfLower, i - 1
                Next i
                For i = 9 To 10
                    PrintLetter vbKeyO, CVar(i), rtfLower, i - 2
                Next i
            Case 927
                For i = 0 To 4
                    PrintLetter vbKeyO, CVar(i), rtfUpper, i
                Next i
                For i = 6 To 7
                    PrintLetter vbKeyO, CVar(i), rtfUpper, i - 1
                Next i
                For i = 9 To 10
                    PrintLetter vbKeyO, CVar(i), rtfUpper, i - 2
                Next i
            Case 961
                PrintLetter vbKeyR, grmNothing, rtfLower, 0
                PrintLetter vbKeyR, grmPsili, rtfLower, 1
                PrintLetter vbKeyR, grmDasia, rtfLower, 2
            Case 929
                PrintLetter vbKeyR, grmNothing, rtfUpper, 0
                PrintLetter vbKeyR, grmDasia, rtfUpper, 1
            Case 963
                PrintLetter vbKeyS, grmNothing, rtfLower, 0
                PrintLetter vbKeyV, grmNothing, rtfLower, 1
            Case 965
                For i = 0 To 16
                    PrintLetter vbKeyU, CVar(i), rtfLower, i
                Next i
            Case 933
                For i = 0 To 13
                    PrintLetter vbKeyU, CVar(i), rtfUpper, i
                Next i
            Case 969
                For i = 0 To 11
                    PrintLetter vbKeyW, CVar(i), rtfLower, i
                Next i
            Case 937
                For i = 0 To 11
                    PrintLetter vbKeyW, CVar(i), rtfUpper, i
                Next i
            Case 8179
                For i = 0 To 11
                    PrintLetter vbKeyW, CVar(i), rtfLowerAlt, i
                Next i
            Case Else
                If rtfMenuAlt And Not rtfMenuShift Then
                    PrintLetter vbKeyA, rtfMarkup, rtfLowerAlt, i
                    i = i + 1
                    PrintLetter vbKeyH, rtfMarkup, rtfLowerAlt, i
                    i = i + 1
                    PrintLetter vbKeyW, rtfMarkup, rtfLowerAlt, i
                    i = i + 1
                Else
                    PrintLetter vbKeyA, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyA, rtfMarkup, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    PrintLetter vbKeyE, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyH, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyH, rtfMarkup, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    PrintLetter vbKeyI, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyO, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyU, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    PrintLetter vbKeyW, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                    i = i + 1
                    If Not rtfMenuShift Then
                        PrintLetter vbKeyW, rtfMarkup, rtfLowerAlt + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    If rtfMenu <> grmVrachy And rtfMenu <> grmMacron Then
                        PrintLetter vbKeySpace, rtfMarkup, rtfLower + IIf(rtfMenuShift, 1, 0), i
                        i = i + 1
                    End If
                    If Not rtfMenuShift Then
                        Select Case rtfMenu
                            Case grmPsili
                                PrintUnicode Asc("]"), i
                            Case grmDasia
                                PrintUnicode Asc("["), i
                            Case grmVaria
                                PrintUnicode Asc("`"), i
                            Case grmOxia
                                PrintUnicode Asc("'"), i
                            Case grmPerispomeni
                                PrintUnicode Asc("="), i
                            Case grmPsiliVaria
                                PrintUnicode Asc("9"), i
                            Case grmPsiliOxia
                                PrintUnicode Asc("8"), i
                            Case grmPsiliPerispomeni
                                PrintUnicode Asc("0"), i
                            Case grmDasiaVaria
                                PrintUnicode Asc("2"), i
                            Case grmDasiaOxia
                                PrintUnicode Asc("1"), i
                            Case grmDasiaPerispomeni
                                PrintUnicode Asc("3"), i
                            Case grmVrachy
                            Case grmMacron
                                PrintUnicode Asc("-"), i
                            Case grmDialyticaVaria
                            Case grmDialyticaOxia
                            Case grmDialyticaPerispomeni
                        End Select
                    Else
                        Select Case rtfMenu
                            Case grmPsili
                                PrintUnicode Asc("}"), i
                            Case grmDasia
                                PrintUnicode Asc("{"), i
                            Case grmVaria
                            Case grmOxia
                            Case grmPerispomeni
                            Case grmPsiliVaria
                                PrintUnicode Asc("("), i
                            Case grmPsiliOxia
                                PrintUnicode Asc("*"), i
                            Case grmPsiliPerispomeni
                                PrintUnicode Asc(")"), i
                            Case grmDasiaVaria
                                PrintUnicode Asc("@"), i
                            Case grmDasiaOxia
                                PrintUnicode Asc("!"), i
                            Case grmDasiaPerispomeni
                                PrintUnicode Asc("#"), i
                            Case grmVrachy
                                PrintUnicode Asc("_"), i
                            Case grmMacron
                            Case grmDialyticaVaria
                                PrintUnicode Asc("~"), i
                            Case grmDialyticaOxia
                                PrintUnicode 34, i
                            Case grmDialyticaPerispomeni
                                PrintUnicode Asc("+"), i
                        End Select
                    End If
                    i = i + 1
                End If
        End Select
    End If
    
    SubMenu = IIf(rtfMenuSub > 0, 13 + 12 * (rtfMenuSub - 1), 0)
    
    Do While myRTF_CacheRTF(SubMenu) = "" And SubMenu > 0
        SubMenu = SubMenu - 1
    Loop
    
    For i = 0 To IIf(rtfMenuSub > 0, 11, 12)
        myRTF(i).SelStart = 0
        myRTF(i).SelLength = Len(myRTF(i).Text)
        myRTF(i).SelRTF = myRTF_CacheRTF(SubMenu)
        myRTF(i).Tag = myRTF_CacheTag(SubMenu)
        SubMenu = SubMenu + 1
    Next i
    If myRTF_CacheRTF(SubMenu + 1) <> "" Then
        If rtfMenuSub > 0 Then
            myRTF(12).SelStart = 0
            myRTF(12).SelLength = Len(myRTF(12).Text)
            myRTF(12).SelText = "<"
            myRTF(12).Tag = 2
        End If
        If myRTF_CacheRTF(SubMenu) <> "" Then
            myRTF(13).SelStart = 0
            myRTF(13).SelLength = Len(myRTF(13).Text)
            myRTF(13).SelText = ">"
            myRTF(13).Tag = 3
        End If
    Else
        If myRTF_CacheRTF(SubMenu) <> "" Then
            myRTF(12).SelStart = 0
            myRTF(12).SelLength = Len(myRTF(i).Text)
            myRTF(12).SelRTF = myRTF_CacheRTF(SubMenu)
            myRTF(12).Tag = myRTF_CacheTag(SubMenu)
        End If
        If rtfMenuSub > 0 Then
            myRTF(13).SelStart = 0
            myRTF(13).SelLength = Len(myRTF(12).Text)
            myRTF(13).SelText = "<"
            myRTF(13).Tag = 2
        End If
    End If
    myRTF(14).SelStart = 0
    myRTF(14).SelLength = Len(myRTF(14).Text)
    myRTF(14).SelText = "?"
    myRTF(14).Tag = 1
        
            
    For i = 0 To 14
        myRTF(i).SelAlignment = rtfCenter
    Next i
    
    i = 0
    myTop = 30
    For j = 0 To 2
        myLeft = 30
        For k = 0 To 4
            myRTF(i).Left = myLeft
            myRTF(i).Top = myTop
            myLeft = myLeft + myRTF(0).Width
            i = i + 1
        Next k
        myTop = myTop + myRTF(0).Height
    Next j
    
    shp1.Visible = True
    shp2.Visible = True
    img1.Visible = True
    
    myRTF(0).SetFocus
End Sub

Public Sub HideMenu()
    Dim i As Integer
    
    rtfMenuVisible = False
     
    For i = 0 To 14
        myRTF(i).Left = UserControl.Width + 1000
    Next i
    
    shp1.Visible = False
    shp2.Visible = False
    img1.Visible = False
    
    RaiseEvent RTFSetFocus
End Sub

Public Sub SetKeyboard(myKeyboard As rtfKeyboardConstants)
    Dim i As Integer
    
    rtfKeyboard = myKeyboard
    
    For i = 0 To 1
        myRTFButton(i).Visible = False
    Next i
    
    myRTFButton(rtfKeyboard).Visible = True
    
    If rtfKeyboard = kbdLatin Then
        rtfHelp.TextRTF = "{\rtf1\ansi\ansicpg1252\deff0\uc1\pard Je kunt eenvoudig tekens typen door alvorens een letter in te tikken op een van de volgende toetsen te drukken:\par \par \b `\b0 , \b '\b0  en \b ^\b0  voor accent;\par \b `\b0  en \b '\b0  met \b shift\b0  voor tilde en trema;\par \b -\b0  en \b _\b0  voor macron en breve.\par \b =\b0  en \b +\b0  voor ring en ligaturen;\par \b .\b0  en \b >\b0  met \b rechter alt\b0  voor onder- en bovenpunt;\par \b ,\b0  en \b <\b0  met \b rechter alt\b0  voor cedille en ogonek;\par \b v\b0  met \b rechter alt\b0  voor caron.\par \par Ook kun je de \b rechter alt\b0  toets ingedrukt houden (eventueel met \b shift\b0 ) terwijl je een toets aanslaat voor extra tekens.\par \par \i Klik met de rechtermuisknop om deze tekst te sluiten.\i0}"
    Else
        rtfHelp.TextRTF = "{\rtf1\ansi\ansicpg1252\deff0\uc1\pard Je kunt eenvoudig tekens typen door alvorens een letter in te tikken op een van de volgende toetsen te drukken:\par \par \b `\b0 , \b '\b0  en \b =\b0  voor accent;\par \b `\b0 , \b '\b0  en \b =\b0  met \b shift\b0  voor accent met trema;\par \b [\b0  en \b ]\b0  voor spiritus;\par \b 1\b0 , \b 2\b0  en \b 3\b0  voor spiritus asper met accent;\par \b 8\b0 , \b 9\b0  en \b 0\b0  voor spiritus lenis met accent;\par \b -\b0  en \b _\b0  voor macron en breve.\par \par Ook kun je de \b rechter alt\b0  toets ingedrukt houden terwijl je een klinker aanslaat voor de iota subscriptum.\par \par \i Klik met de rechtermuisknop om deze tekst te sluiten.\i0}"
    End If
End Sub

Public Sub RTFValidate(ByVal LastCharRTF As String, ByRef Cancel As Boolean)
    'sigma check
    If InStr(1, LastCharRTF, "\u963?") > 0 Then
       PrintUnicode 962
    End If
End Sub

Public Sub RTFSetFont(Bold As Boolean, Italic As Boolean, Underline As Boolean, Strikethrough As Boolean)
    Dim i As Integer
    
    For i = 0 To 14
        With myRTF(i).Font
            .Bold = Bold
            .Italic = Italic
            .Underline = Underline
            .Strikethrough = Strikethrough
        End With
    Next i
End Sub
